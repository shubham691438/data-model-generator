{
  "integrations": [
    {
      "type": "WriteApiIntegration",
      "integrationId": "tetrapak-create-candidate",
      "responseConfig": {
        "responseType": "SINGLE_ENTITY",
        "jsonataExpression": "$.data"
      },
      "dataModelRules": [
        {
          "type": "BooleanExpressionRule",
          "jsonataExpression": "$exists(inputData.firstName) and inputData.firstName != null"
        },
        {
          "type": "BooleanExpressionRule",
          "jsonataExpression": "$exists(inputData.email) and inputData.email != null"
        }
      ],
      "dataModelTarget": {
        "dataModelJsonataExpression": "{ \"JOVEO_CANDIDATE_ID\": $uuid(), \"JOVEO_CANDIDATE_CUSTOMER_ID\": \"{{customer_id}}\", \"ATS_CANDIDATE_ID\": $.id, \"ATS_CANDIDATE_FIRST_NAME\": $.first_name, \"ATS_CANDIDATE_LAST_NAME\": $.last_name, \"ATS_CANDIDATE_EMAIL\": $.email, \"ATS_CANDIDATE_PHONE_NUMBERS\": [$.phone], \"ATS_CANDIDATE_ADDRESS\": { \"street\": $.address.street, \"city\": $.address.city, \"state\": $.address.state, \"country\": $.address.country, \"postal_code\": $.address.postal_code }, \"ATS_CANDIDATE_CREATED_DATE\": $fromMillis($toMillis($replace($.created_at, /\\+\\d{2}:\\d{2}$/, \"\") & \"Z\")), \"ATS_CANDIDATE_LAST_UPDATED_DATE\": $fromMillis($toMillis($replace($.updated_at, /\\+\\d{2}:\\d{2}$/, \"\") & \"Z\")), \"ATS_CANDIDATE_INSERTED_AT\": $now(), \"ATS_CANDIDATE_UPDATED_AT\": $now(), \"ATS_CANDIDATE_IS_DELETED\": false, \"ATS_CANDIDATE_CUSTOM_FIELDS\": { \"experience_years\": $.experience_years, \"current_position\": $.current_position, \"current_company\": $.current_company, \"skills\": $.skills, \"education\": $.education }, \"ATS_CANDIDATE_AUDIT\": { \"created_by\": $.created_by, \"updated_by\": $.updated_by } }",
        "targetFields": [
          "JOVEO_CANDIDATE_ID", "JOVEO_CANDIDATE_CUSTOMER_ID", "ATS_CANDIDATE_ID", "ATS_CANDIDATE_FIRST_NAME", "ATS_CANDIDATE_LAST_NAME", "ATS_CANDIDATE_EMAIL", "ATS_CANDIDATE_PHONE_NUMBERS", "ATS_CANDIDATE_ADDRESS", "ATS_CANDIDATE_CREATED_DATE", "ATS_CANDIDATE_LAST_UPDATED_DATE", "ATS_CANDIDATE_INSERTED_AT", "ATS_CANDIDATE_UPDATED_AT", "ATS_CANDIDATE_IS_DELETED", "ATS_CANDIDATE_CUSTOM_FIELDS", "ATS_CANDIDATE_AUDIT"
        ],
        "targetOperation": "INSERT"
      },
      "method": "POST",
      "authTypes": ["API_KEY"],
      "apiPath": "/api/v1/candidates",
      "headers": {
        "X-API-KEY": "{{api_key}}",
        "Content-Type": "application/json",
        "Accept": "application/json"
      },
      "requestPayload": {
        "requestBody": "{\"first_name\": \"${inputData.firstName}\", \"last_name\": \"${inputData.lastName}\", \"email\": \"${inputData.email}\", \"phone\": \"${inputData.phone}\", \"address\": { \"street\": \"${inputData.address.street}\", \"city\": \"${inputData.address.city}\", \"state\": \"${inputData.address.state}\", \"country\": \"${inputData.address.country}\", \"postal_code\": \"${inputData.address.postalCode}\" }, \"experience_years\": ${inputData.experienceYears}, \"current_position\": \"${inputData.currentPosition}\", \"current_company\": \"${inputData.currentCompany}\", \"skills\": ${inputData.skills}, \"education\": ${inputData.education}}",
        "requestBodyConverter": []
      },
      "responseHandlers": [
        {
          "statusCode": 201,
          "bodyRules": [
            {
              "type": "BooleanExpressionRule",
              "jsonataExpression": "$exists($.id)"
            }
          ],
          "jsonataConvertorExpression": "{ \"candidateId\": $.id, \"status\": \"created\" }"
        },
        {
          "statusCode": 400,
          "bodyRules": [
            {
              "type": "BooleanExpressionRule",
              "jsonataExpression": "true"
            }
          ],
          "jsonataConvertorExpression": "{ \"errorMessage\": \"Invalid candidate data\", \"details\": $.message }"
        },
        {
          "statusCode": 0,
          "bodyRules": [
            {
              "type": "BooleanExpressionRule",
              "jsonataExpression": "true"
            }
          ],
          "jsonataConvertorExpression": "{ \"errorMessage\": \"Integration not executed\" }"
        }
      ]
    },
    {
      "type": "WriteApiIntegration",
      "integrationId": "tetrapak-update-candidate",
      "responseConfig": {
        "responseType": "SINGLE_ENTITY",
        "jsonataExpression": "$.data"
      },
      "dataModelRules": [
        {
          "type": "BooleanExpressionRule",
          "jsonataExpression": "$exists(inputData.candidateId) and inputData.candidateId != null"
        }
      ],
      "dataModelTarget": {
        "dataModelJsonataExpression": "{ \"JOVEO_CANDIDATE_ID\": $uuid(), \"JOVEO_CANDIDATE_CUSTOMER_ID\": \"{{customer_id}}\", \"ATS_CANDIDATE_ID\": $.id, \"ATS_CANDIDATE_FIRST_NAME\": $.first_name, \"ATS_CANDIDATE_LAST_NAME\": $.last_name, \"ATS_CANDIDATE_EMAIL\": $.email, \"ATS_CANDIDATE_PHONE_NUMBERS\": [$.phone], \"ATS_CANDIDATE_ADDRESS\": { \"street\": $.address.street, \"city\": $.address.city, \"state\": $.address.state, \"country\": $.address.country, \"postal_code\": $.address.postal_code }, \"ATS_CANDIDATE_CREATED_DATE\": $fromMillis($toMillis($replace($.created_at, /\\+\\d{2}:\\d{2}$/, \"\") & \"Z\")), \"ATS_CANDIDATE_LAST_UPDATED_DATE\": $fromMillis($toMillis($replace($.updated_at, /\\+\\d{2}:\\d{2}$/, \"\") & \"Z\")), \"ATS_CANDIDATE_INSERTED_AT\": $now(), \"ATS_CANDIDATE_UPDATED_AT\": $now(), \"ATS_CANDIDATE_IS_DELETED\": false, \"ATS_CANDIDATE_CUSTOM_FIELDS\": { \"experience_years\": $.experience_years, \"current_position\": $.current_position, \"current_company\": $.current_company, \"skills\": $.skills, \"education\": $.education }, \"ATS_CANDIDATE_AUDIT\": { \"created_by\": $.created_by, \"updated_by\": $.updated_by } }",
        "targetFields": [
          "JOVEO_CANDIDATE_ID", "JOVEO_CANDIDATE_CUSTOMER_ID", "ATS_CANDIDATE_ID", "ATS_CANDIDATE_FIRST_NAME", "ATS_CANDIDATE_LAST_NAME", "ATS_CANDIDATE_EMAIL", "ATS_CANDIDATE_PHONE_NUMBERS", "ATS_CANDIDATE_ADDRESS", "ATS_CANDIDATE_CREATED_DATE", "ATS_CANDIDATE_LAST_UPDATED_DATE", "ATS_CANDIDATE_INSERTED_AT", "ATS_CANDIDATE_UPDATED_AT", "ATS_CANDIDATE_IS_DELETED", "ATS_CANDIDATE_CUSTOM_FIELDS", "ATS_CANDIDATE_AUDIT"
        ],
        "targetOperation": "UPSERT"
      },
      "method": "PUT",
      "authTypes": ["API_KEY"],
      "apiPath": "/api/v1/candidates/{candidateId}",
      "headers": {
        "X-API-KEY": "{{api_key}}",
        "Content-Type": "application/json",
        "Accept": "application/json"
      },
      "requestPayload": {
        "requestBody": "{\"first_name\": \"${inputData.firstName}\", \"last_name\": \"${inputData.lastName}\", \"email\": \"${inputData.email}\", \"phone\": \"${inputData.phone}\", \"address\": { \"street\": \"${inputData.address.street}\", \"city\": \"${inputData.address.city}\", \"state\": \"${inputData.address.state}\", \"country\": \"${inputData.address.country}\", \"postal_code\": \"${inputData.address.postalCode}\" }, \"experience_years\": ${inputData.experienceYears}, \"current_position\": \"${inputData.currentPosition}\", \"current_company\": \"${inputData.currentCompany}\", \"skills\": ${inputData.skills}, \"education\": ${inputData.education}}",
        "requestBodyConverter": []
      },
      "responseHandlers": [
        {
          "statusCode": 200,
          "bodyRules": [
            {
              "type": "BooleanExpressionRule",
              "jsonataExpression": "$exists($.id)"
            }
          ],
          "jsonataConvertorExpression": "{ \"candidateId\": $.id, \"status\": \"updated\" }"
        },
        {
          "statusCode": 404,
          "bodyRules": [
            {
              "type": "BooleanExpressionRule",
              "jsonataExpression": "true"
            }
          ],
          "jsonataConvertorExpression": "{ \"errorMessage\": \"Candidate not found\", \"details\": $.message }"
        },
        {
          "statusCode": 0,
          "bodyRules": [
            {
              "type": "BooleanExpressionRule",
              "jsonataExpression": "true"
            }
          ],
          "jsonataConvertorExpression": "{ \"errorMessage\": \"Integration not executed\" }"
        }
      ]
    },
    {
      "type": "ReadApiIntegration",
      "integrationId": "tetrapak-get-candidates",
      "responseConfig": {
        "responseType": "ARRAY_OF_ENTITIES",
        "jsonataExpression": "$.data.candidates"
      },
      "dataModelRules": [
        {
          "type": "BooleanExpressionRule",
          "jsonataExpression": "$count($$) > 0"
        },
        {
          "type": "BooleanExpressionRule",
          "jsonataExpression": "$exists($.id) and $.id != null"
        }
      ],
      "dataModelTarget": {
        "dataModelJsonataExpression": "$map($$, function($candidate) { { \"JOVEO_CANDIDATE_ID\": $uuid(), \"JOVEO_CANDIDATE_CUSTOMER_ID\": \"{{customer_id}}\", \"ATS_CANDIDATE_ID\": $candidate.id, \"ATS_CANDIDATE_FIRST_NAME\": $candidate.first_name, \"ATS_CANDIDATE_LAST_NAME\": $candidate.last_name, \"ATS_CANDIDATE_EMAIL\": $candidate.email, \"ATS_CANDIDATE_PHONE_NUMBERS\": [$candidate.phone], \"ATS_CANDIDATE_ADDRESS\": { \"street\": $candidate.address.street, \"city\": $candidate.address.city, \"state\": $candidate.address.state, \"country\": $candidate.address.country, \"postal_code\": $candidate.address.postal_code }, \"ATS_CANDIDATE_CREATED_DATE\": $fromMillis($toMillis($replace($candidate.created_at, /\\+\\d{2}:\\d{2}$/, \"\") & \"Z\")), \"ATS_CANDIDATE_LAST_UPDATED_DATE\": $fromMillis($toMillis($replace($candidate.updated_at, /\\+\\d{2}:\\d{2}$/, \"\") & \"Z\")), \"ATS_CANDIDATE_INSERTED_AT\": $now(), \"ATS_CANDIDATE_UPDATED_AT\": $now(), \"ATS_CANDIDATE_IS_DELETED\": false, \"ATS_CANDIDATE_CUSTOM_FIELDS\": { \"experience_years\": $candidate.experience_years, \"current_position\": $candidate.current_position, \"current_company\": $candidate.current_company, \"skills\": $candidate.skills, \"education\": $candidate.education }, \"ATS_CANDIDATE_AUDIT\": { \"created_by\": $candidate.created_by, \"updated_by\": $candidate.updated_by } } })",
        "targetFields": [
          "JOVEO_CANDIDATE_ID", "JOVEO_CANDIDATE_CUSTOMER_ID", "ATS_CANDIDATE_ID", "ATS_CANDIDATE_FIRST_NAME", "ATS_CANDIDATE_LAST_NAME", "ATS_CANDIDATE_EMAIL", "ATS_CANDIDATE_PHONE_NUMBERS", "ATS_CANDIDATE_ADDRESS", "ATS_CANDIDATE_CREATED_DATE", "ATS_CANDIDATE_LAST_UPDATED_DATE", "ATS_CANDIDATE_INSERTED_AT", "ATS_CANDIDATE_UPDATED_AT", "ATS_CANDIDATE_IS_DELETED", "ATS_CANDIDATE_CUSTOM_FIELDS", "ATS_CANDIDATE_AUDIT"
        ],
        "targetOperation": "UPSERT"
      },
      "method": "GET",
      "authTypes": ["API_KEY"],
      "apiPath": "/api/v1/candidates",
      "headers": {
        "X-API-KEY": "{{api_key}}",
        "Content-Type": "application/json",
        "Accept": "application/json"
      },
      "queryParams": {
        "page": "${page}",
        "size": "100"
      },
      "paginationConfig": {
        "type": "PageConfig",
        "pageSize": 100,
        "pageNumberKey": "page",
        "hasMoreDataJsonataExpression": "$exists($.data.next_page)"
      },
      "dateRangeConfig": {
        "startDateTimeKey": "createdSince",
        "endDateTimeKey": "createdBefore",
        "dateTimeFormat": "yyyy-MM-dd'T'HH:mm:ss"
      }
    }
  ]
}
